<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Streaming Tasks · Dagger.jl</title><meta name="title" content="Streaming Tasks · Dagger.jl"/><meta property="og:title" content="Streaming Tasks · Dagger.jl"/><meta property="twitter:title" content="Streaming Tasks · Dagger.jl"/><meta name="description" content="Documentation for Dagger.jl."/><meta property="og:description" content="Documentation for Dagger.jl."/><meta property="twitter:description" content="Documentation for Dagger.jl."/><meta property="og:url" content="https://JuliaParallel.github.io/Dagger.jl/streaming/"/><meta property="twitter:url" content="https://JuliaParallel.github.io/Dagger.jl/streaming/"/><link rel="canonical" href="https://JuliaParallel.github.io/Dagger.jl/streaming/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Dagger.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Dagger.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Use Cases</span><ul><li><a class="tocitem" href="../use-cases/parallel-nested-loops/">Parallel Nested Loops</a></li></ul></li><li><a class="tocitem" href="../task-spawning/">Task Spawning</a></li><li><a class="tocitem" href="../data-management/">Data Management</a></li><li><a class="tocitem" href="../darray/">Distributed Arrays</a></li><li class="is-active"><a class="tocitem" href>Streaming Tasks</a></li><li><a class="tocitem" href="../scopes/">Scopes</a></li><li><a class="tocitem" href="../processors/">Processors</a></li><li><a class="tocitem" href="../task-queues/">Task Queues</a></li><li><a class="tocitem" href="../datadeps/">Datadeps</a></li><li><a class="tocitem" href="../propagation/">Option Propagation</a></li><li><span class="tocitem">Logging and Visualization</span><ul><li><a class="tocitem" href="../logging/">Logging: Basics</a></li><li><a class="tocitem" href="../logging-visualization/">Logging: Visualization</a></li><li><a class="tocitem" href="../logging-advanced/">Logging: Advanced</a></li></ul></li><li><span class="tocitem">External Languages</span><ul><li><a class="tocitem" href="../external-languages/python/">Python</a></li></ul></li><li><a class="tocitem" href="../checkpointing/">Checkpointing</a></li><li><a class="tocitem" href="../benchmarking/">Benchmarking</a></li><li><a class="tocitem" href="../dynamic/">Dynamic Scheduler Control</a></li><li><a class="tocitem" href="../scheduler-internals/">Scheduler Internals</a></li><li><span class="tocitem">Dagger API</span><ul><li><a class="tocitem" href="../api-dagger/types/">Types</a></li><li><a class="tocitem" href="../api-dagger/functions/">Functions and Macros</a></li></ul></li><li><span class="tocitem">TimespanLogging API</span><ul><li><a class="tocitem" href="../api-timespanlogging/types/">Types</a></li><li><a class="tocitem" href="../api-timespanlogging/functions/">Functions and Macros</a></li></ul></li><li><span class="tocitem">DaggerWebDash API</span><ul><li><a class="tocitem" href="../api-daggerwebdash/types/">Types</a></li><li><a class="tocitem" href="../api-daggerwebdash/functions/">Functions and Macros</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Streaming Tasks</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Streaming Tasks</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaParallel/Dagger.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaParallel/Dagger.jl/blob/master/docs/src/streaming.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Streaming"><a class="docs-heading-anchor" href="#Streaming">Streaming</a><a id="Streaming-1"></a><a class="docs-heading-anchor-permalink" href="#Streaming" title="Permalink"></a></h1><p>Dagger tasks have a limited lifetime - they are created, execute, finish, and are eventually destroyed when they&#39;re no longer needed. Thus, if one wants to run the same kind of computations over and over, one might re-create a similar set of tasks for each unit of data that needs processing.</p><p>This might be fine for computations which take a long time to run (thus dwarfing the cost of task creation, which is quite small), or when working with a limited set of data, but this approach is not great for doing lots of small computations on a large (or endless) amount of data. For example, processing image frames from a webcam, reacting to messages from a message bus, reading samples from a software radio, etc. All of these tasks are better suited to a &quot;streaming&quot; model of data processing, where data is simply piped into a continuously-running task (or DAG of tasks) forever, or until the data runs out.</p><p>Thankfully, if you have a problem which is best modeled as a streaming system of tasks, Dagger has you covered! Building on its support for <a href="../task-queues/#Task-Queues">Task Queues</a>, Dagger provides a means to convert an entire DAG of tasks into a streaming DAG, where data flows into and out of each task asynchronously, using the <code>spawn_streaming</code> function:</p><pre><code class="language-julia hljs">Dagger.spawn_streaming() do # enters a streaming region
  vals = Dagger.@spawn rand()
  print_vals = Dagger.@spawn println(vals)
end # exits the streaming region, and starts the DAG running</code></pre><p>In the above example, <code>vals</code> is a Dagger task which has been transformed to run in a streaming manner - instead of just calling <code>rand()</code> once and returning its result, it will re-run <code>rand()</code> endlessly, continuously producing new random values. In typical Dagger style, <code>print_vals</code> is a Dagger task which depends on <code>vals</code>, but in streaming form - it will continuously <code>println</code> the random values produced from <code>vals</code>. Both tasks will run forever, and will run efficiently, only doing the work necessary to generate, transfer, and consume values.</p><p>As the comments point out, <code>spawn_streaming</code> creates a streaming region, during which <code>vals</code> and <code>print_vals</code> are created and configured. Both tasks are halted until <code>spawn_streaming</code> returns, allowing large DAGs to be built all at once, without any task losing a single value. If desired, streaming regions can be connected, although some values might be lost while tasks are being connected:</p><pre><code class="language-julia hljs">vals = Dagger.spawn_streaming() do
    Dagger.@spawn rand()
end

# Some values might be generated by `vals` but thrown away
# before `print_vals` is fully setup and connected to it

print_vals = Dagger.spawn_streaming() do
    Dagger.@spawn println(vals)
end</code></pre><p>More complicated streaming DAGs can be easily constructed, without doing anything different. For example, we can generate multiple streams of random numbers, write them all to their own files, and print the combined results:</p><pre><code class="language-julia hljs">Dagger.spawn_streaming() do
    all_vals = [Dagger.spawn(rand) for i in 1:4]
    all_vals_written = map(1:4) do i
        Dagger.spawn(all_vals[i]) do val
            open(&quot;results_$i.txt&quot;; write=true, create=true, append=true) do io
                println(io, repr(val))
            end
            return val
        end
    end
    Dagger.spawn(all_vals_written...) do all_vals_written...
        vals_sum = sum(all_vals_written)
        println(vals_sum)
    end
end</code></pre><p>If you want to stop the streaming DAG and tear it all down, you can call <code>Dagger.cancel!(all_vals[1])</code> (or with any other task in the streaming DAG) to terminate all streaming tasks.</p><p>Alternatively, tasks can stop themselves from the inside with <code>finish_stream</code>, optionally returning a value that can be <code>fetch</code>&#39;d. Let&#39;s do this when our randomly-drawn number falls within some arbitrary range:</p><pre><code class="language-julia hljs">vals = Dagger.spawn_streaming() do
    Dagger.spawn() do
        x = rand()
        if x &lt; 0.001
            # That&#39;s good enough, let&#39;s be done
            return Dagger.finish_stream(&quot;Finished!&quot;)
        end
        return x
    end
end
fetch(vals)</code></pre><p>In this example, the call to <code>fetch</code> will hang (while random numbers continue to be drawn), until a drawn number is less than 0.001; at that point, <code>fetch</code> will return with <code>&quot;Finished!&quot;</code>, and the task <code>vals</code> will have terminated.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../darray/">« Distributed Arrays</a><a class="docs-footer-nextpage" href="../scopes/">Scopes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Wednesday 4 June 2025 21:01">Wednesday 4 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
